name: PreProd Freeze Window Check

on:
  pull_request:
    branches:
      - pre_prod
  workflow_dispatch:

jobs:
  freeze-check:
    runs-on: ubuntu-latest
    steps:
      - name: Determine current time window (IST 5-6 PM)
        id: window
        run: |
          # The logic to determine if the current time is within 5-6 PM IST
          # and set the step output 'within_window' to 'true' or 'false'.
          # (Your original time logic seems correct, assuming you've validated it)
          ... # (Your existing time and output logic lines 15-28)
          
      - name: Auto-pass during freeze open window
        if: ${{ steps.window.outputs.within_window == 'true' }}
        run: |
          echo "Allowed window. Auto pass."
          # You might want to skip the final failing check if it's an auto-pass
          
      # --- The step that should *fail* outside the window ---
      - name: Fail outside 5-6 PM IST
        if: ${{ steps.window.outputs.within_window == 'false' }}
        run: |
          echo "Freeze active. PR requires manual approval or must wait."
          exit 1 # This is the crucial line that makes the check fail!
